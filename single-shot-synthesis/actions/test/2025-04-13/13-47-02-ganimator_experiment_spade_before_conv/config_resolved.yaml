engine:
  runner:
    _target_: moai.engine.runner.LightningRunner
    check_val_every_n_epoch: 1
    gradient_clip_val: 0
    gradient_clip_algorithm: norm
    accumulate_grad_batches: 1
    limit_train_batches: 1.0
    limit_val_batches: 1.0
    limit_test_batches: 1.0
    limit_predict_batches: 1.0
    val_check_interval: 1.0
    reload_dataloaders_every_n_epochs: 0
    deterministic: false
    auto_lr_find: false
    terminate_on_nan: false
    auto_scale_batch_size: false
    relative_tolerance: 1.0e-09
    gradient_tolerance: 1.0e-09
    num_nodes: 1
    num_processes: 1
    accelerator: auto
    devices: 1
    gpus:
    - 0
    precision: 32
    benchmark: false
    auto_select_gpus: false
    amp_backend: native
    amp_level: null
    prepare_data_per_node: true
    replace_sampler_ddp: true
    strategy: auto
    enable_model_summary: true
    detect_anomaly: false
    flush_logs_every_n_steps: 1
    log_every_n_steps: 1
    progress_bar_refresh_rate: 1
    weights_summary: top
    profiler: simple
    default_root_dir: ''
    fast_dev_run: false
    num_sanity_val_steps: 0
    track_grad_norm: -1
    process_position: 0
    move_metrics_to_cpu: false
    multiple_trainloader_mode: max_size_cycle
    stochastic_weight_avg: false
    checkpoint:
      _target_: pytorch_lightning.callbacks.ModelCheckpoint
      monitor: fid/repeated_npz
      verbose: false
      save_weights_only: true
      mode: min
      save_top_k: 3
      save_last: true
      dirpath: null
      filename: '{epoch}-{fid/repeated_npz:.8f}'
      auto_insert_metric_name: true
      every_n_train_steps: null
      train_time_interval: null
      every_n_epochs: 1
      save_on_train_epoch_end: false
    loggers:
      clearml:
        _target_: moai.log.loggers.clearml.ClearML
    max_epochs: 4
  modules:
    manual_seed:
      _target_: moai.engine.modules.seed.ManualSeed
      seed: 1337
      deterministic: true
    import:
      _target_: moai.engine.modules.importer.Import
      run_path: true
      other_paths: []
    clearml:
      _target_: moai.engine.modules.clearml.ClearML
      project_name: GANimator
      task_name: ganimator_experiment_spade_before_conv
      uri: null
      tags:
      - train
      connect_args: false
      connect_libs: false
      connect_res: false
      continue_last_task: false
    numpy:
      _target_: moai.engine.modules.numpy.Numpy
    rerun:
      annotations:
        parents:
          mixamo:
          - -1
          - 0
          - 1
          - 2
          - 3
          - 4
          - 0
          - 6
          - 7
          - 8
          - 9
          - 0
          - 11
          - 12
          - 13
          - 14
          - 13
          - 16
          - 17
          - 18
          - 13
          - 20
          - 21
          - 22
        labels:
          mixamo:
          - Hips
          - LeftUpLeg
          - LeftLeg
          - LeftFoot
          - LeftToeBase
          - LeftToe_End
          - RightUpLeg
          - RightLeg
          - RightFoot
          - RightToeBase
          - RightToe_End
          - Spine
          - Spine1
          - Spine2
          - Neck
          - Head
          - LeftShoulder
          - LeftArm
          - LeftForeArm
          - LeftHand
          - RightShoulder
          - RightArm
          - RightForeArm
          - RightHand
data:
  train:
    loader:
      _target_: torch.utils.data.DataLoader
      batch_size: 2
      shuffle: true
      num_workers: 0
      pin_memory: false
      drop_last: false
      prefetch_factor: null
      persistent_workers: false
      pin_memory_device: ''
    iterator:
      _target_: moai.data.iterator.Indexed
      datasets:
        repeated_npz:
          _target_: moai.data.datasets.generic.npz.RepeatedNpzUpdated
          filename:
          - C:/Users/tsele/Documents/Mixamo/npz/both_npz_testing_0_1/salsa.npz
          - C:/Users/tsele/Documents/Mixamo/npz/both_npz_testing_0_1/swing.npz
          length: 15000
  val:
    loader:
      _target_: torch.utils.data.DataLoader
      batch_size: 2
      shuffle: false
      num_workers: 0
      pin_memory: true
      drop_last: false
      prefetch_factor: null
    iterator:
      _target_: moai.data.iterator.Indexed
      datasets:
        repeated_npz:
          _target_: moai.data.datasets.generic.npz.RepeatedNpzUpdated
          filename:
          - C:/Users/tsele/Documents/Mixamo/npz/both_npz_testing_0_1/salsa.npz
          - C:/Users/tsele/Documents/Mixamo/npz/both_npz_testing_0_1/swing.npz
          length: 200
  test:
    loader:
      _target_: torch.utils.data.DataLoader
      batch_size: 2
      shuffle: false
      num_workers: 0
      pin_memory: false
      drop_last: false
      prefetch_factor: null
      persistent_workers: false
      pin_memory_device: ''
    iterator:
      _target_: moai.data.iterator.Indexed
      datasets:
        repeated_npz:
          _target_: moai.data.datasets.generic.npz.RepeatedNpzUpdated
          filename:
          - C:/Users/tsele/Documents/Mixamo/npz/both_npz_testing_0_1/salsa.npz
          - C:/Users/tsele/Documents/Mixamo/npz/both_npz_testing_0_1/swing.npz
          length: 5
model:
  _target_: moai.core.model.MoaiLightningModule
  components:
    gen_s1:
      _target_: src.components.ganimator.Generator
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
      contacts:
      - 4
      - 5
      - 9
      - 10
      kernel_size: 5
      padding_mode: reflect
      bias: true
      stages: 2
    gen_s4:
      _target_: src.components.ganimator.Generator
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
      contacts:
      - 4
      - 5
      - 9
      - 10
      kernel_size: 5
      padding_mode: reflect
      bias: true
      stages: 1
    disc_s1:
      _target_: src.components.ganimator.Discriminator
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
      contacts:
      - 4
      - 5
      - 9
      - 10
      kernel_size: 5
      padding_mode: reflect
      bias: true
      stages: 2
    disc_s4:
      _target_: src.components.ganimator.Discriminator
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
      contacts:
      - 4
      - 5
      - 9
      - 10
      kernel_size: 5
      padding_mode: reflect
      bias: true
      stages: 1
    gen_s2:
      _target_: src.components.ganimator.Generator
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
      contacts:
      - 4
      - 5
      - 9
      - 10
      kernel_size: 5
      padding_mode: reflect
      bias: true
      stages: 2
    gen_s3:
      _target_: src.components.ganimator.Generator
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
      contacts:
      - 4
      - 5
      - 9
      - 10
      kernel_size: 5
      padding_mode: reflect
      bias: true
      stages: 2
    disc_s2:
      _target_: src.components.ganimator.Discriminator
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
      contacts:
      - 4
      - 5
      - 9
      - 10
      kernel_size: 5
      padding_mode: reflect
      bias: true
      stages: 2
    disc_s3:
      _target_: src.components.ganimator.Discriminator
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
      contacts:
      - 4
      - 5
      - 9
      - 10
      kernel_size: 5
      padding_mode: reflect
      bias: true
      stages: 2
  monads:
    interpolate:
      _target_: moai.monads.sampling.torch.interpolate.Interpolate
      scale: 1.0
      width: -1
      height: -1
      mode: linear
      align_corners: false
      recompute_scale_factor: false
      preserve_aspect_ratio: false
    random:
      _target_: moai.monads.generation.tensor.torch.Random
      shape: 1
      mode: unit
      scale: 1.0
      includes_batch: false
    matrix_transpose:
      _target_: moai.monads.math.common.MatrixTranspose
    rad2deg:
      _target_: moai.monads.math.Rad2Deg
    rotmat_to_euler:
      _target_: moai.monads.geometry.rotations.euler.RotationMatrixToEuler
      order: XYZ
    gram_schmidt:
      _target_: moai.monads.geometry.rotations.gram_schmidt.GramSchmidt
    roma_rotmat_to_sixd:
      _target_: moai.monads.geometry.rotations.gram_schmidt.ExtractSixd
    rotmat_to_unitquat:
      _target_: moai.monads.geometry.rotations.conversions.RotationMatrix2Quaternion
    roma_rotmat_to_rotvec:
      _target_: moai.monads.geometry.rotations.RomaRotationMatrix2RotationVector
    fake_history_level_0:
      _target_: moai.monads.generative.fake_history.GradualFakeHistory
      history_size: 50
      percentage: 0.5
    fake_history_level_1:
      _target_: moai.monads.generative.fake_history.GradualFakeHistory
      history_size: 50
      percentage: 0.5
    index:
      _target_: moai.monads.masking.mask.Index
      indices:
      - 4
      - 5
      - 9
      - 10
      dim: -2
      persistent: true
    encode_motion:
      _target_: src.monads.feature_extractors.movement_encoder.MotionEncoderBiGRUCo
      ckpt: C:/Users/tsele/Documents/t2m/text_mot_match/model/finest.tar
    encode_movement:
      _target_: src.monads.feature_extractors.movement_encoder.MovementConvEncoder
      ckpt: C:/Users/tsele/Documents/t2m/text_mot_match/model/finest.tar
    forward_kinematics:
      _target_: moai.monads.human.pose.forward_kinematics.ForwardKinematics
      parents:
      - -1
      - 0
      - 1
      - 2
      - 3
      - 4
      - 0
      - 6
      - 7
      - 8
      - 9
      - 0
      - 11
      - 12
      - 13
      - 14
      - 13
      - 16
      - 17
      - 18
      - 13
      - 20
      - 21
      - 22
    root_angular_velocity:
      _target_: src.monads.utils.root_velocity.AngularVelocity
      zero_pad: true
    root_linear_velocity_xz:
      _target_: src.monads.utils.root_velocity.LinearVelocityXZ
    create_random_clips:
      _target_: src.monads.utils.create_clips.CreateRandomClips
      window_size: 35
    create_mdm_repr:
      _target_: src.monads.utils.create_mdm_representation.MDMRepresentation
    index_last:
      _target_: moai.monads.masking.Index
      indices: 0
      dim: -1
      persistent: true
    index_root:
      _target_: moai.monads.masking.Index
      indices: 0
      dim: -3
      persistent: true
    index_root_pos:
      _target_: moai.monads.masking.Index
      indices: 0
      dim: -2
      persistent: true
    force_grad:
      _target_: src.monads.utils.force_grad.ForceGrad
    demux:
      _target_: src.monads.utils.demux.DeMux
      joints: 24
      features: 6
    simple_velocity:
      _target_: src.monads.utils.simple_velocity.SimpleVelocity
      zero_pad: true
    simple_velocity_val:
      _target_: src.monads.utils.simple_velocity.SimpleVelocity
      zero_pad: true
      return_norm: false
    integrate_velocity:
      _target_: src.monads.utils.integrate_velocity.IntegrateVelocity
      ignore_y: true
    to_smplh:
      _target_: src.monads.utils.smplh.ToSMPLH
      from_joint_number: 24
      mapping:
      - - 0
      - - 1
      - - 6
      - - 11
      - - 2
      - - 7
      - - 12
      - - 3
      - - 8
      - - 13
      - - 5
      - - 10
      - - 14
      - - 13
        - 16
      - - 13
        - 20
      - - 15
      - - 16
      - - 20
      - - 17
      - - 21
      - - 18
      - - 22
    spade:
      _target_: src.monads.utils.spade.Spade
    scalar:
      value: -1
  modifications:
    forward_mode:
      _target_: moai.remodel.forward_mode.ForwardMode
      modules: null
      monads: null
  parameters:
    initializers:
      partial:
        _target_: moai.parameters.initialization.partial.Partial
        named_components.gen_s1:
          from: C:/Users/tsele/Documents/GitHub/Blendanim/single-shot-synthesis/actions/fit/2025-04-12/10-52-38-ganimator_experiment_not_the_4th_gs/GANimator/ganimator_experiment_not_the_4th_gs/checkpoints/last.ckpt
          keys:
          - '*.gen_s1.*'
          replace:
          - source: models.gen_s1.
            target: null
        named_components.gen_s2:
          from: C:/Users/tsele/Documents/GitHub/Blendanim/single-shot-synthesis/actions/fit/2025-04-12/10-52-38-ganimator_experiment_not_the_4th_gs/GANimator/ganimator_experiment_not_the_4th_gs/checkpoints/last.ckpt
          keys:
          - '*.gen_s2.*'
          replace:
          - source: models.gen_s2.
            target: null
        named_components.gen_s3:
          from: C:/Users/tsele/Documents/GitHub/Blendanim/single-shot-synthesis/actions/fit/2025-04-12/10-52-38-ganimator_experiment_not_the_4th_gs/GANimator/ganimator_experiment_not_the_4th_gs/checkpoints/last.ckpt
          keys:
          - '*.gen_s3.*'
          replace:
          - source: models.gen_s3.
            target: null
        named_components.gen_s4:
          from: C:/Users/tsele/Documents/GitHub/Blendanim/single-shot-synthesis/actions/fit/2025-04-12/10-52-38-ganimator_experiment_not_the_4th_gs/GANimator/ganimator_experiment_not_the_4th_gs/checkpoints/last.ckpt
          keys:
          - '*.gen_s4.*'
          replace:
          - source: models.gen_s4.
            target: null
    optimizers:
      adam:
        _target_: torch.optim.Adam
        lr: 0.0001
        betas:
        - 0.9
        - 0.999
        eps: 1.0e-08
        weight_decay: 0.0
        amsgrad: false
    groups:
      gen_s1:
        _target_: moai.parameters.selectors.model.ModelParameterSelector
        modules:
        - gen_s1
      gen_s2:
        _target_: moai.parameters.selectors.model.ModelParameterSelector
        modules:
        - gen_s2
      gen_s3:
        _target_: moai.parameters.selectors.model.ModelParameterSelector
        modules:
        - gen_s3
      gen_s4:
        _target_: moai.parameters.selectors.model.ModelParameterSelector
        modules:
        - gen_s4
      disc_s1:
        _target_: moai.parameters.selectors.model.ModelParameterSelector
        modules:
        - disc_s1
      disc_s2:
        _target_: moai.parameters.selectors.model.ModelParameterSelector
        modules:
        - disc_s2
      disc_s3:
        _target_: moai.parameters.selectors.model.ModelParameterSelector
        modules:
        - disc_s3
      disc_s4:
        _target_: moai.parameters.selectors.model.ModelParameterSelector
        modules:
        - disc_s4
  objectives:
    L1:
      _target_: moai.supervision.objectives.regression.L1.L1
      mode: raw
      bias: 0.0
    gradient_penalty:
      _target_: moai.supervision.objectives.generative.gradient_penalty.GradientPenalty
    disc_wasserstein:
      _target_: src.supervision.generative.wasserstein.DiscriminatorWasserstein
      per_batch: false
    gen_wasserstein:
      _target_: src.supervision.generative.wasserstein.GeneratorWasserstein
      per_batch: false
    velocity:
      _target_: src.supervision.custom.velocity.VeloLabelConsistencyLoss
  metrics:
    fid:
      _target_: moai.validation.metrics.generation.fid.FID
    coverage:
      _target_: src.metrics.generation.ganimator_metrics.Coverage
      tmin: 30
      threshold: 2.0
    gdiv:
      _target_: src.metrics.generation.ganimator_metrics.GlobalDiversity
      tmin: 30
    ldiv:
      _target_: src.metrics.generation.ganimator_metrics.LocalDiversity
      tmin: 15
      keepall: false
    mdm_gdiv:
      _target_: src.metrics.generation.mdm_metrics.MDMInterDiversity
    mdm_ldiv:
      _target_: src.metrics.generation.mdm_metrics.MDMIntraDiversity
  monitors:
    bvh:
      _target_: src.exporters.bvh.bvh_export
      _partial_: true
CKPT: C:/Users/tsele/Documents/GitHub/Blendanim/single-shot-synthesis/actions/fit/2025-04-12/10-52-38-ganimator_experiment_not_the_4th_gs/GANimator/ganimator_experiment_not_the_4th_gs/checkpoints/last.ckpt
experiment:
  batch_size: 2
  workers: 0
  name: ganimator_experiment_spade_before_conv
npz_filename:
- C:/Users/tsele/Documents/Mixamo/npz/both_npz_testing_0_1/salsa.npz
- C:/Users/tsele/Documents/Mixamo/npz/both_npz_testing_0_1/swing.npz
train_data_iter: 15000
feet_indices:
- 4
- 5
- 9
- 10
gen_prototype:
  _target_: src.components.ganimator.Generator
  parents:
  - -1
  - 0
  - 1
  - 2
  - 3
  - 4
  - 0
  - 6
  - 7
  - 8
  - 9
  - 0
  - 11
  - 12
  - 13
  - 14
  - 13
  - 16
  - 17
  - 18
  - 13
  - 20
  - 21
  - 22
  contacts:
  - 4
  - 5
  - 9
  - 10
  kernel_size: 5
  padding_mode: reflect
  bias: true
  stages: 2
disc_prototype:
  _target_: src.components.ganimator.Discriminator
  parents:
  - -1
  - 0
  - 1
  - 2
  - 3
  - 4
  - 0
  - 6
  - 7
  - 8
  - 9
  - 0
  - 11
  - 12
  - 13
  - 14
  - 13
  - 16
  - 17
  - 18
  - 13
  - 20
  - 21
  - 22
  contacts:
  - 4
  - 5
  - 9
  - 10
  kernel_size: 5
  padding_mode: reflect
  bias: true
  stages: 2
_moai_:
  _definitions_:
    _flows_:
      gen_s1:
        noise0:
        - noise_level_0
        noise1:
        - noise_level_1
        skeleton_id_map:
        - skeleton_id_map_level_x
        generated:
        - prev
        _out_:
        - fake
      gen_s2:
        noise0:
        - noise_level_2
        noise1:
        - noise_level_3
        skeleton_id_map:
        - skeleton_id_map_level_x
        generated:
        - prev
        _out_:
        - fake
      gen_s3:
        noise0:
        - noise_level_4
        noise1:
        - noise_level_5
        skeleton_id_map:
        - skeleton_id_map_level_x
        generated:
        - prev
        _out_:
        - fake
      gen_s4:
        noise0:
        - noise_level_6
        skeleton_id_map:
        - skeleton_id_map_level_x
        generated:
        - prev
        _out_:
        - fake
      disc_s1:
        fake0:
        - fake.stage0
        - motion_data_level_x
        - interpolated_0
        fake1:
        - fake.stage1
        - motion_data_level_y
        - interpolated_1
        _out_:
        - fake_score
        - real_score
        - interpolated_score
      disc_s2:
        fake0:
        - fake.stage0
        - motion_data_level_x
        - interpolated_0
        fake1:
        - fake.stage1
        - motion_data_level_y
        - interpolated_1
        _out_:
        - fake_score
        - real_score
        - interpolated_score
      disc_s3:
        fake0:
        - fake.stage0
        - motion_data_level_x
        - interpolated_0
        fake1:
        - fake.stage1
        - motion_data_level_y
        - interpolated_1
        _out_:
        - fake_score
        - real_score
        - interpolated_score
      disc_s4:
        fake0:
        - fake.stage0
        - motion_data_level_x
        - interpolated_0
        _out_:
        - fake_score
        - real_score
        - interpolated_score
      horizontal_input_mapping:
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: mul
            children:
            - !!python/object:lark.tree.Tree
              data: randn_like
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - motion_data_level_0
                - 6
                - 1
                - 7
              _meta: null
            - !!python/object:lark.tree.Tree
              data: unsqueeze
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - amps_level_0
                - 34
                - 1
                - 35
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 48
                - 1
                - 49
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 51
                - 1
                - 52
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: mul
            children:
            - !!python/object:lark.tree.Tree
              data: randn_like
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - motion_data_level_1
                - 6
                - 1
                - 7
              _meta: null
            - !!python/object:lark.tree.Tree
              data: unsqueeze
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - amps_level_1
                - 34
                - 1
                - 35
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 48
                - 1
                - 49
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 51
                - 1
                - 52
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: mul
            children:
            - !!python/object:lark.tree.Tree
              data: randn_like
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - motion_data_level_2
                - 6
                - 1
                - 7
              _meta: null
            - !!python/object:lark.tree.Tree
              data: unsqueeze
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - amps_level_2
                - 34
                - 1
                - 35
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 48
                - 1
                - 49
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 51
                - 1
                - 52
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: mul
            children:
            - !!python/object:lark.tree.Tree
              data: randn_like
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - motion_data_level_3
                - 6
                - 1
                - 7
              _meta: null
            - !!python/object:lark.tree.Tree
              data: unsqueeze
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - amps_level_3
                - 34
                - 1
                - 35
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 48
                - 1
                - 49
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 51
                - 1
                - 52
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: mul
            children:
            - !!python/object:lark.tree.Tree
              data: randn_like
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - motion_data_level_4
                - 6
                - 1
                - 7
              _meta: null
            - !!python/object:lark.tree.Tree
              data: unsqueeze
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - amps_level_4
                - 34
                - 1
                - 35
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 48
                - 1
                - 49
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 51
                - 1
                - 52
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: mul
            children:
            - !!python/object:lark.tree.Tree
              data: randn_like
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - motion_data_level_5
                - 6
                - 1
                - 7
              _meta: null
            - !!python/object:lark.tree.Tree
              data: unsqueeze
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - amps_level_5
                - 34
                - 1
                - 35
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 48
                - 1
                - 49
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 51
                - 1
                - 52
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: mul
            children:
            - !!python/object:lark.tree.Tree
              data: randn_like
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - motion_data_level_6
                - 6
                - 1
                - 7
              _meta: null
            - !!python/object:lark.tree.Tree
              data: unsqueeze
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - amps_level_6
                - 34
                - 1
                - 35
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 48
                - 1
                - 49
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 51
                - 1
                - 52
              _meta: null
            _meta: null
          _out_:
          - noise_level_0
          - noise_level_1
          - noise_level_2
          - noise_level_3
          - noise_level_4
          - noise_level_5
          - noise_level_6
      stage_1:
        _mi_:
          expression:
          - motion_data_level_0
          - motion_data_level_1
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_0
              - 6
              - 1
              - 7
            _meta: null
          - skeleton_id_map_level_0
          - skeleton_id_map_level_1
          _out_:
          - motion_data_level_x
          - motion_data_level_y
          - prev
          - skeleton_id_map_level_x
          - skeleton_id_map_level_y
      stage_1_reco:
        _mi_:
          expression:
          - z_star
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_1
              - 6
              - 1
              - 7
            _meta: null
          _out_:
          - noise_level_0
          - noise_level_1
      stage_2:
        interpolate:
          image:
          - fake.stage1
          target:
          - motion_data_level_2
          _out_:
          - prev
        _mi_:
          expression:
          - motion_data_level_2
          - motion_data_level_3
          - skeleton_id_map_level_2
          - skeleton_id_map_level_3
          _out_:
          - motion_data_level_x
          - motion_data_level_y
          - skeleton_id_map_level_x
          - skeleton_id_map_level_y
      stage_2_reco:
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_2
              - 6
              - 1
              - 7
            _meta: null
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_3
              - 6
              - 1
              - 7
            _meta: null
          _out_:
          - noise_level_2
          - noise_level_3
      stage_3:
        interpolate:
          image:
          - fake.stage1
          target:
          - motion_data_level_4
          _out_:
          - prev
        _mi_:
          expression:
          - motion_data_level_4
          - motion_data_level_5
          - skeleton_id_map_level_4
          - skeleton_id_map_level_5
          _out_:
          - motion_data_level_x
          - motion_data_level_y
          - skeleton_id_map_level_x
          - skeleton_id_map_level_y
      stage_3_reco:
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_4
              - 6
              - 1
              - 7
            _meta: null
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_5
              - 6
              - 1
              - 7
            _meta: null
          _out_:
          - noise_level_4
          - noise_level_5
      stage_4:
        interpolate:
          image:
          - fake.stage1
          target:
          - motion_data_level_6
          _out_:
          - prev
        _mi_:
          expression:
          - motion_data_level_6
          - skeleton_id_map_level_6
          _out_:
          - motion_data_level_x
          - skeleton_id_map_level_x
      stage_4_reco:
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_6
              - 6
              - 1
              - 7
            _meta: null
          _out_:
          - noise_level_6
      stage_1_val:
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: mul
            children:
            - !!python/object:lark.tree.Tree
              data: randn_like
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - motion_data_level_0
                - 6
                - 1
                - 7
              _meta: null
            - !!python/object:lark.tree.Tree
              data: unsqueeze
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - amps_level_0
                - 34
                - 1
                - 35
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 48
                - 1
                - 49
              - !!python/object/apply:lark.lexer.Token
                - SIGNED_INT
                - '1'
                - 51
                - 1
                - 52
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_1
              - 6
              - 1
              - 7
            _meta: null
          - motion_data_level_0
          - motion_data_level_1
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_0
              - 6
              - 1
              - 7
            _meta: null
          - skeleton_id_map_level_0
          - skeleton_id_map_level_1
          _out_:
          - noise_level_0
          - noise_level_1
          - motion_data_level_x
          - motion_data_level_y
          - prev
          - skeleton_id_map_level_x
          - skeleton_id_map_level_y
      stage_2_val:
        interpolate:
          image:
          - fake.stage1
          target:
          - motion_data_level_2
          _out_:
          - prev
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_2
              - 6
              - 1
              - 7
            _meta: null
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_3
              - 6
              - 1
              - 7
            _meta: null
          - motion_data_level_2
          - motion_data_level_3
          - skeleton_id_map_level_2
          - skeleton_id_map_level_3
          _out_:
          - noise_level_2
          - noise_level_3
          - motion_data_level_x
          - motion_data_level_y
          - skeleton_id_map_level_x
          - skeleton_id_map_level_y
      stage_3_val:
        interpolate:
          image:
          - fake.stage1
          target:
          - motion_data_level_4
          _out_:
          - prev
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_4
              - 6
              - 1
              - 7
            _meta: null
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_5
              - 6
              - 1
              - 7
            _meta: null
          - motion_data_level_4
          - motion_data_level_5
          - skeleton_id_map_level_4
          - skeleton_id_map_level_5
          _out_:
          - noise_level_4
          - noise_level_5
          - motion_data_level_x
          - motion_data_level_y
          - skeleton_id_map_level_x
          - skeleton_id_map_level_y
      stage_4_val:
        interpolate:
          image:
          - fake.stage1
          target:
          - motion_data_level_6
          _out_:
          - prev
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: zeros_like
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_6
              - 6
              - 1
              - 7
            _meta: null
          - motion_data_level_6
          - skeleton_id_map_level_6
          _out_:
          - noise_level_6
          - motion_data_level_x
          - skeleton_id_map_level_x
      disc_prediscrimination:
        random:
          tensor:
          - motion_data_level_x
          - motion_data_level_y
          _out_:
          - blend_0
          - blend_1
        force_grad:
          tensor:
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_x
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_0
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage0
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_0
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_y
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_1
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage1
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_1
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          _out_:
          - interpolated_0
          - interpolated_1
        fake_history_level_0:
          fake:
          - fake.stage0
          _out_:
          - fake_level_0
        fake_history_level_1:
          fake:
          - fake.stage1
          _out_:
          - fake_level_1
      disc_prediscrimination_s4:
        random:
          tensor:
          - motion_data_level_x
          _out_:
          - blend_0
        force_grad:
          tensor:
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_x
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_0
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage0
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_0
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          _out_:
          - interpolated_0
        fake_history_level_0:
          fake:
          - fake.stage0
          _out_:
          - fake_level_0
      sample_prediscrimination:
        random:
          tensor:
          - motion_data_level_x
          - motion_data_level_y
          _out_:
          - blend_0
          - blend_1
        force_grad:
          tensor:
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_x
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_0
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage0
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_0
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_y
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_1
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage1
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_1
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          _out_:
          - interpolated_0
          - interpolated_1
        demux:
          motion_data:
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fake
                - 10
                - 1
                - 11
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - stage0
                - 15
                - 1
                - 16
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 23
              - 1
              - 24
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 27
              - 1
              - 28
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fake
                - 10
                - 1
                - 11
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - stage1
                - 15
                - 1
                - 16
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 23
              - 1
              - 24
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 27
              - 1
              - 28
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_x
              - 10
              - 1
              - 11
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 31
              - 1
              - 32
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_y
              - 10
              - 1
              - 11
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 31
              - 1
              - 32
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          _out_:
          - demuxed_0
          - demuxed_1
          - demuxed_gt_0
          - demuxed_gt_1
        gram_schmidt:
          sixd:
          - demuxed_0.joint_sixd
          - demuxed_1.joint_sixd
          - demuxed_gt_0.joint_sixd
          - demuxed_gt_1.joint_sixd
          _out_:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_1
          - demuxed_gt_joint_rotmat_0
          - demuxed_gt_joint_rotmat_1
        integrate_velocity:
          velocity:
          - demuxed_0.root_position
          - demuxed_1.root_position
          - demuxed_gt_0.root_position
          - demuxed_gt_1.root_position
          position:
          - root_position
          - root_position
          - root_position
          - root_position
          _out_:
          - global_root_position_0
          - global_root_position_1
          - global_root_position_0_gt
          - global_root_position_1_gt
        forward_kinematics:
          rotation:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_1
          - demuxed_gt_joint_rotmat_0
          - demuxed_gt_joint_rotmat_1
          position:
          - global_root_position_0
          - global_root_position_1
          - global_root_position_0_gt
          - global_root_position_1_gt
          offsets:
          - joint_offsets
          - joint_offsets
          - joint_offsets
          - joint_offsets
          parents:
          - joint_parents
          - joint_parents
          - joint_parents
          - joint_parents
          _out_:
          - fk_0_pred
          - fk_1_pred
          - fk_0_gt
          - fk_1_gt
        simple_velocity:
          positions:
          - !!python/object:lark.tree.Tree
            data: slicing
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fk_0_pred
                - 0
                - 1
                - 1
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - positions
                - 10
                - 1
                - 11
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 20
              - 1
              - 21
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 22
              - 1
              - 23
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - indices
              - 881
              - 35
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '4'
                - 25
                - 1
                - 26
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '5'
                - 28
                - 1
                - 29
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '9'
                - 31
                - 1
                - 32
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '10'
                - 34
                - 1
                - 35
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: slicing
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fk_1_pred
                - 0
                - 1
                - 1
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - positions
                - 10
                - 1
                - 11
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 20
              - 1
              - 21
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 22
              - 1
              - 23
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - indices
              - 881
              - 35
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '4'
                - 25
                - 1
                - 26
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '5'
                - 28
                - 1
                - 29
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '9'
                - 31
                - 1
                - 32
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '10'
                - 34
                - 1
                - 35
              _meta: null
            _meta: null
          _out_:
          - velocities_0
          - velocities_1
      sample_prediscrimination_s4:
        random:
          tensor:
          - motion_data_level_x
          _out_:
          - blend_0
        force_grad:
          tensor:
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_x
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_0
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage0
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_0
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          _out_:
          - interpolated_0
        demux:
          motion_data:
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fake
                - 10
                - 1
                - 11
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - stage0
                - 15
                - 1
                - 16
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 23
              - 1
              - 24
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 27
              - 1
              - 28
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_x
              - 10
              - 1
              - 11
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 31
              - 1
              - 32
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          _out_:
          - demuxed_0
          - demuxed_gt_0
        gram_schmidt:
          sixd:
          - demuxed_0.joint_sixd
          - demuxed_gt_0.joint_sixd
          _out_:
          - demuxed_joint_rotma_0
          - demuxed_gt_joint_rotmat_0
        integrate_velocity:
          velocity:
          - demuxed_0.root_position
          - demuxed_gt_0.root_position
          position:
          - root_position
          - root_position
          _out_:
          - global_root_position_0
          - global_root_position_0_gt
        forward_kinematics:
          rotation:
          - demuxed_joint_rotma_0
          - demuxed_gt_joint_rotmat_0
          position:
          - global_root_position_0
          - global_root_position_0_gt
          offsets:
          - joint_offsets
          - joint_offsets
          parents:
          - joint_parents
          - joint_parents
          _out_:
          - fk_0_pred
          - fk_0_gt
        simple_velocity:
          positions:
          - !!python/object:lark.tree.Tree
            data: slicing
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fk_0_pred
                - 0
                - 1
                - 1
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - positions
                - 10
                - 1
                - 11
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 20
              - 1
              - 21
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 22
              - 1
              - 23
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - indices
              - 881
              - 35
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '4'
                - 25
                - 1
                - 26
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '5'
                - 28
                - 1
                - 29
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '9'
                - 31
                - 1
                - 32
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '10'
                - 34
                - 1
                - 35
              _meta: null
            _meta: null
          _out_:
          - velocities_0
      reco_prediscrimination:
        random:
          tensor:
          - motion_data_level_x
          - motion_data_level_y
          _out_:
          - blend_0
          - blend_1
        force_grad:
          tensor:
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_x
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_0
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage0
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_0
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_y
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_1
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage1
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_1
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          _out_:
          - interpolated_0
          - interpolated_1
        demux:
          motion_data:
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fake
                - 10
                - 1
                - 11
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - stage0
                - 15
                - 1
                - 16
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 23
              - 1
              - 24
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 27
              - 1
              - 28
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fake
                - 10
                - 1
                - 11
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - stage1
                - 15
                - 1
                - 16
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 23
              - 1
              - 24
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 27
              - 1
              - 28
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_x
              - 10
              - 1
              - 11
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 31
              - 1
              - 32
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_y
              - 10
              - 1
              - 11
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 31
              - 1
              - 32
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          _out_:
          - demuxed_0
          - demuxed_1
          - demuxed_gt_0
          - demuxed_gt_1
        gram_schmidt:
          sixd:
          - demuxed_0.joint_sixd
          - demuxed_1.joint_sixd
          - demuxed_gt_0.joint_sixd
          - demuxed_gt_1.joint_sixd
          _out_:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_1
          - demuxed_gt_joint_rotmat_0
          - demuxed_gt_joint_rotmat_1
        integrate_velocity:
          velocity:
          - demuxed_0.root_position
          - demuxed_1.root_position
          - demuxed_gt_0.root_position
          - demuxed_gt_1.root_position
          position:
          - root_position
          - root_position
          - root_position
          - root_position
          _out_:
          - global_root_position_0
          - global_root_position_1
          - global_root_position_0_gt
          - global_root_position_1_gt
        forward_kinematics:
          rotation:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_1
          - demuxed_gt_joint_rotmat_0
          - demuxed_gt_joint_rotmat_1
          position:
          - global_root_position_0
          - global_root_position_1
          - global_root_position_0_gt
          - global_root_position_1_gt
          offsets:
          - joint_offsets
          - joint_offsets
          - joint_offsets
          - joint_offsets
          parents:
          - joint_parents
          - joint_parents
          - joint_parents
          - joint_parents
          _out_:
          - fk_0_pred
          - fk_1_pred
          - fk_0_gt
          - fk_1_gt
        simple_velocity:
          positions:
          - !!python/object:lark.tree.Tree
            data: slicing
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fk_0_pred
                - 0
                - 1
                - 1
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - positions
                - 10
                - 1
                - 11
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 20
              - 1
              - 21
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 22
              - 1
              - 23
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - indices
              - 881
              - 35
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '4'
                - 25
                - 1
                - 26
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '5'
                - 28
                - 1
                - 29
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '9'
                - 31
                - 1
                - 32
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '10'
                - 34
                - 1
                - 35
              _meta: null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: slicing
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fk_1_pred
                - 0
                - 1
                - 1
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - positions
                - 10
                - 1
                - 11
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 20
              - 1
              - 21
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 22
              - 1
              - 23
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - indices
              - 881
              - 35
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '4'
                - 25
                - 1
                - 26
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '5'
                - 28
                - 1
                - 29
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '9'
                - 31
                - 1
                - 32
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '10'
                - 34
                - 1
                - 35
              _meta: null
            _meta: null
          _out_:
          - velocities_0
          - velocities_1
      reco_prediscrimination_s4:
        random:
          tensor:
          - motion_data_level_x
          _out_:
          - blend_0
        force_grad:
          tensor:
          - !!python/object:lark.tree.Tree
            data: add
            children:
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - motion_data_level_x
                  - 1
                  - 1
                  - 2
                _meta: null
              - !!python/object:lark.tree.Tree
                data: unsqueeze
                children:
                - !!python/object/apply:lark.lexer.Token
                  - FIELD
                  - blend_0
                  - 28
                  - 1
                  - 29
                - !!python/object/apply:lark.lexer.Token
                  - SIGNED_INT
                  - '1'
                  - 37
                  - 1
                  - 38
                _meta: null
              _meta: null
            - !!python/object:lark.tree.Tree
              data: mul
              children:
              - !!python/object:lark.tree.Tree
                data: extract
                children:
                - !!python/object:lark.tree.Tree
                  data: !!python/object/apply:lark.lexer.Token
                  - RULE
                  - name
                  - 7
                  - 3
                  - 6
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - fake
                    - 44
                    - 1
                    - 45
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - stage0
                    - 49
                    - 1
                    - 50
                  _meta: null
                _meta: null
              - !!python/object:lark.tree.Tree
                data: sub
                children:
                - !!python/object:lark.tree.Tree
                  data: number
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - NUMBER
                    - '1'
                    - 59
                    - 1
                    - 60
                  _meta: null
                - !!python/object:lark.tree.Tree
                  data: unsqueeze
                  children:
                  - !!python/object/apply:lark.lexer.Token
                    - FIELD
                    - blend_0
                    - 68
                    - 1
                    - 69
                  - !!python/object/apply:lark.lexer.Token
                    - SIGNED_INT
                    - '1'
                    - 77
                    - 1
                    - 78
                  _meta: null
                _meta: null
              _meta: null
            _meta: null
          _out_:
          - interpolated_0
        demux:
          motion_data:
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fake
                - 10
                - 1
                - 11
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - stage0
                - 15
                - 1
                - 16
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 23
              - 1
              - 24
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 27
              - 1
              - 28
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_x
              - 10
              - 1
              - 11
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 31
              - 1
              - 32
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          _out_:
          - demuxed_0
          - demuxed_gt_0
        gram_schmidt:
          sixd:
          - demuxed_0.joint_sixd
          - demuxed_gt_0.joint_sixd
          _out_:
          - demuxed_joint_rotma_0
          - demuxed_gt_joint_rotmat_0
        integrate_velocity:
          velocity:
          - demuxed_0.root_position
          - demuxed_gt_0.root_position
          position:
          - root_position
          - root_position
          _out_:
          - global_root_position_0
          - global_root_position_0_gt
        forward_kinematics:
          rotation:
          - demuxed_joint_rotma_0
          - demuxed_gt_joint_rotmat_0
          position:
          - global_root_position_0
          - global_root_position_0_gt
          offsets:
          - joint_offsets
          - joint_offsets
          parents:
          - joint_parents
          - joint_parents
          _out_:
          - fk_0_pred
          - fk_0_gt
        simple_velocity:
          positions:
          - !!python/object:lark.tree.Tree
            data: slicing
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fk_0_pred
                - 0
                - 1
                - 1
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - positions
                - 10
                - 1
                - 11
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 20
              - 1
              - 21
            - !!python/object/apply:lark.lexer.Token
              - ALL
              - ':'
              - 22
              - 1
              - 23
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - indices
              - 881
              - 35
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '4'
                - 25
                - 1
                - 26
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '5'
                - 28
                - 1
                - 29
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '9'
                - 31
                - 1
                - 32
              - !!python/object/apply:lark.lexer.Token
                - INT
                - '10'
                - 34
                - 1
                - 35
              _meta: null
            _meta: null
          _out_:
          - velocities_0
      val_prediscrimination:
        matrix_transpose:
          matrix:
          - fake.stage0
          - motion_data_level_x
          _out_:
          - fake_level_0_T
          - motion_data_level_0_T
        demux:
          motion_data:
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fake
                - 10
                - 1
                - 11
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - stage1
                - 15
                - 1
                - 16
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 23
              - 1
              - 24
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 27
              - 1
              - 28
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_y
              - 10
              - 1
              - 11
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 31
              - 1
              - 32
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          _out_:
          - demuxed_0
          - demuxed_gt_0
      val_prediscrimination_last:
        matrix_transpose:
          matrix:
          - fake.stage0
          - motion_data_level_x
          _out_:
          - fake_level_0_T
          - motion_data_level_0_T
        demux:
          motion_data:
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - fake
                - 10
                - 1
                - 11
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - stage0
                - 15
                - 1
                - 16
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 23
              - 1
              - 24
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 27
              - 1
              - 28
            _meta: null
          - !!python/object:lark.tree.Tree
            data: transpose
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - motion_data_level_x
              - 10
              - 1
              - 11
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-2'
              - 31
              - 1
              - 32
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          _out_:
          - demuxed_0
          - demuxed_gt_0
      val_prediscrimination_post:
        gram_schmidt:
          sixd:
          - demuxed_0.joint_sixd
          - demuxed_gt_0.joint_sixd
          _out_:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_0_gt
        integrate_velocity:
          velocity:
          - demuxed_0.root_position
          - demuxed_gt_0.root_position
          position:
          - root_position
          - root_position
          _out_:
          - global_root_position_0
          - global_root_position_0_gt
        forward_kinematics:
          rotation:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_0_gt
          position:
          - global_root_position_0
          - global_root_position_0_gt
          offsets:
          - joint_offsets
          - joint_offsets
          parents:
          - joint_parents
          - joint_parents
          _out_:
          - fk_0_pred
          - fk_0_gt
        index_last:
          tensor:
          - demuxed_0.contact_feats
          _out_:
          - contacts
        rotmat_to_euler:
          rotation:
          - demuxed_joint_rotma_0
          _out_:
          - demuxed_joint_euler_0
        roma_rotmat_to_sixd:
          matrix:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_0_gt
          _out_:
          - joint_rotations_sixd
          - joint_rotations_sixd_gt
        _mi_:
          expression:
          - !!python/object:lark.tree.Tree
            data: flatten
            children:
            - !!python/object/apply:lark.lexer.Token
              - FIELD
              - joint_rotations_sixd
              - 8
              - 1
              - 9
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '2'
              - 30
              - 1
              - 31
            - null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: flatten
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - demuxed_0
                - 8
                - 1
                - 9
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - contact_feats
                - 18
                - 1
                - 19
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '2'
              - 33
              - 1
              - 34
            - null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: flatten
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - demuxed_gt_0
                - 8
                - 1
                - 9
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - joint_sixd
                - 21
                - 1
                - 22
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '2'
              - 33
              - 1
              - 34
            - null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: flatten
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - name
              - 7
              - 3
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - demuxed_gt_0
                - 8
                - 1
                - 9
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - contact_feats
                - 21
                - 1
                - 22
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '2'
              - 36
              - 1
              - 37
            - null
            _meta: null
          - !!python/object:lark.tree.Tree
            data: cat
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - names
              - 37
              - 4
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - joint_sixd
                - 4
                - 1
                - 5
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - gen_contact_feats
                - 16
                - 1
                - 17
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 35
              - 1
              - 36
            _meta: null
          - !!python/object:lark.tree.Tree
            data: cat
            children:
            - !!python/object:lark.tree.Tree
              data: !!python/object/apply:lark.lexer.Token
              - RULE
              - names
              - 37
              - 4
              - 6
              children:
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - gt_sixd
                - 4
                - 1
                - 5
              - !!python/object/apply:lark.lexer.Token
                - FIELD
                - gt_contact_feats
                - 13
                - 1
                - 14
              _meta: null
            - !!python/object/apply:lark.lexer.Token
              - SIGNED_INT
              - '-1'
              - 31
              - 1
              - 32
            _meta: null
          - demuxed_joint_rotma_0
          - fk_0_pred.positions
          - demuxed_0.root_position
          _out_:
          - joint_sixd
          - gen_contact_feats
          - gt_sixd
          - gt_contact_feats
          - gen_feats
          - gt_feats
          - joint_rotations
          - joint_positions
          - joint_velocity
        to_smplh:
          positions:
          - fk_0_pred.positions
          - fk_0_gt.positions
          rotations:
          - joint_rotations_sixd
          - joint_rotations_sixd_gt
          _out_:
          - smplh
          - smplh_gt
        simple_velocity_val:
          positions:
          - smplh.positions
          - smplh_gt.positions
          _out_:
          - smplh_joints_velocity
          - smplh_joints_velocity_gt
        index_root:
          tensor:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_0_gt
          _out_:
          - r_rotmat
          - r_rotmat_gt
        index_root_pos:
          tensor:
          - smplh_joints_velocity
          - smplh_joints_velocity_gt
          _out_:
          - r_velocity
          - r_velocity_gt
        rotmat_to_unitquat:
          rotation:
          - r_rotmat
          - r_rotmat_gt
          _out_:
          - r_quat
          - r_quat_gt
        root_linear_velocity_xz:
          velocity:
          - r_velocity
          - r_velocity_gt
          rotations:
          - r_quat
          - r_quat_gt
          _out_:
          - r_linear_velocity
          - r_linear_velocity_gt
        root_angular_velocity:
          rotations:
          - r_quat
          - r_quat_gt
          _out_:
          - r_angular_velocity
          - r_angular_velocity_gt
        create_mdm_repr:
          positions:
          - smplh.positions
          - smplh_gt.positions
          rotations:
          - smplh.rotations
          - smplh_gt.rotations
          velocities:
          - smplh_joints_velocity
          - smplh_joints_velocity_gt
          linear:
          - r_linear_velocity
          - r_linear_velocity_gt
          angular:
          - r_angular_velocity
          - r_angular_velocity_gt
          _out_:
          - mdm
          - mdm_gt
        create_random_clips:
          motion:
          - mdm
          - mdm_gt
          _out_:
          - mdm_clips
          - mdm_gt_clips
        encode_movement:
          inputs:
          - mdm
          - mdm_gt
          - mdm_clips
          - mdm_gt_clips
          _out_:
          - movement_embed
          - movement_embed_gt
          - clips_movement_embeds
          - clips_movement_embeds_gt
        encode_motion:
          inputs:
          - movement_embed
          - movement_embed_gt
          - clips_movement_embeds
          - clips_movement_embeds_gt
          _out_:
          - motion_embed
          - motion_embed_gt
          - clips_embeds
          - clips_embeds_gt
      test_prediscrimination_post:
        gram_schmidt:
          sixd:
          - demuxed_0.joint_sixd
          - demuxed_gt_0.joint_sixd
          _out_:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_0_gt
        rotmat_to_euler:
          rotation:
          - demuxed_joint_rotma_0
          _out_:
          - demuxed_joint_euler_0
        rad2deg:
          radians:
          - demuxed_joint_euler_0
          _out_:
          - demuxed_joint_euler_0
        integrate_velocity:
          velocity:
          - demuxed_0.root_position
          - demuxed_gt_0.root_position
          position:
          - root_position
          - root_position
          _out_:
          - global_root_position_0
          - global_root_position_0_gt
        forward_kinematics:
          rotation:
          - demuxed_joint_rotma_0
          - demuxed_joint_rotma_0_gt
          position:
          - global_root_position_0
          - global_root_position_0_gt
          offsets:
          - joint_offsets
          - joint_offsets
          parents:
          - joint_parents
          - joint_parents
          _out_:
          - fk_0_pred
          - fk_0_gt
    _collections_:
      _optimizers_:
        optim_disc:
          _type_: adam
          _params_:
            lr: 0.0001
          _groups_:
          - disc_s1
        optim_gen:
          _type_: adam
          _params_:
            lr: 0.0001
          _groups_:
          - gen_s1
        optim_disc_stage_1:
          _type_: adam
          _params_:
            lr: 0.0001
          _groups_:
          - disc_s2
        optim_gen_stage_1:
          _type_: adam
          _params_:
            lr: 0.0001
          _groups_:
          - gen_s2
        optim_disc_stage_2:
          _type_: adam
          _params_:
            lr: 0.0001
          _groups_:
          - disc_s3
        optim_gen_stage_2:
          _type_: adam
          _params_:
            lr: 0.0001
          _groups_:
          - gen_s3
        optim_disc_stage_3:
          _type_: adam
          _params_:
            lr: 0.0001
          _groups_:
          - disc_s4
        optim_gen_stage_3:
          _type_: adam
          _params_:
            lr: 0.0001
          _groups_:
          - gen_s4
      _objectives_:
        discriminate:
          disc_wasserstein:
            real:
            - real_score.stage0
            - real_score.stage1
            fake:
            - fake_score.stage0
            - fake_score.stage1
            _weight_:
            - 1.0
            - 1.0
            _reduction_:
            - sum
            - sum
            _out_:
            - D_0
            - D_1
          gradient_penalty:
            blended_samples:
            - interpolated_0
            - interpolated_1
            blended_scores:
            - interpolated_score.stage0
            - interpolated_score.stage1
            _weight_:
            - 1.0
            - 1.0
            _out_:
            - GP_0
            - GP_1
        discriminate_last:
          disc_wasserstein:
            real:
            - real_score.stage0
            fake:
            - fake_score.stage0
            _weight_:
            - 1.0
            _reduction_:
            - sum
            _out_:
            - D_0
          gradient_penalty:
            blended_samples:
            - interpolated_0
            blended_scores:
            - interpolated_score.stage0
            _weight_:
            - 1.0
            _out_:
            - GP_0
        sample:
          gen_wasserstein:
            fake:
            - fake_score.stage0
            - fake_score.stage1
            _weight_:
            - 1.0
            - 1.0
            _reduction_:
            - sum
            - sum
            _out_:
            - fake_G_0
            - fake_G_1
          velocity:
            pred:
            - demuxed_0.contact_labels
            - demuxed_1.contact_labels
            gt:
            - velocities_0
            - velocities_1
            _weight_:
            - 5.0
            - 5.0
            _out_:
            - foot_consistency_0
            - foot_consistency_1
        sample_last:
          gen_wasserstein:
            fake:
            - fake_score.stage0
            _weight_:
            - 1.0
            _reduction_:
            - sum
            _out_:
            - fake_G_0
          velocity:
            pred:
            - demuxed_0.contact_labels
            gt:
            - velocities_0
            _weight_:
            - 5.0
            _out_:
            - foot_consistency_0
        reco:
          L1:
            gt:
            - motion_data_level_x
            - motion_data_level_y
            - skeleton_id_map_level_x
            pred:
            - fake.stage0
            - fake.stage1
            _weight_:
            - 50.0
            - 50.0
            _out_:
            - rec_0
            - rec_1
        reco_last:
          L1:
            gt:
            - motion_data_level_x
            - skeleton_id_map_level_x
            pred:
            - fake.stage0
            _weight_:
            - 50.0
            _out_:
            - rec_0
      _metrics_:
        features:
          coverage:
            pred:
            - gen_feats
            gt:
            - gt_feats
            _out_:
            - coverage
          gdiv:
            pred:
            - gen_feats
            gt:
            - gt_feats
            _out_:
            - ganimator_gdiv
          ldiv:
            pred:
            - gen_feats
            gt:
            - gt_feats
            _out_:
            - ganimator_ldiv
          mdm_gdiv:
            pred:
            - motion_embed
            gt:
            - motion_embed_gt
            _out_:
            - mdm_gdiv
          mdm_ldiv:
            pred:
            - clips_embeds
            gt:
            - clips_embeds_gt
            _out_:
            - mdm_ldiv
          fid:
            pred:
            - clips_embeds
            gt:
            - clips_embeds_gt
            _out_:
            - fid
      _monitors_:
        export_generated_skeleton:
          bvh:
            output_name:
            - salsa-swing_dance
            export_path:
            - C:/Users/tsele/Documents/Mixamo/generated/bvh
            parents:
            - joint_parents
            position:
            - global_root_position_0
            rotations:
            - demuxed_joint_euler_0
            offsets:
            - joint_offsets
            scale:
            - 100.0
            names:
            - - Hips
              - LeftUpLeg
              - LeftLeg
              - LeftFoot
              - LeftToeBase
              - LeftToe_End
              - RightUpLeg
              - RightLeg
              - RightFoot
              - RightToeBase
              - RightToe_End
              - Spine
              - Spine1
              - Spine2
              - Neck
              - Head
              - LeftShoulder
              - LeftArm
              - LeftForeArm
              - LeftHand
              - RightShoulder
              - RightArm
              - RightForeArm
              - RightHand
  _execution_:
    _initialize_:
      _test_:
        _setup_:
        - partial
    _lightning_step_:
      _test_:
        _datasets_:
          repeated_npz:
            _flows_:
            - stage_1_val
            - gen_s1
            - stage_2_val
            - gen_s2
            - stage_3_val
            - gen_s3
            - stage_4_val
            - gen_s4
            - val_prediscrimination_last
            - test_prediscrimination_post
    _schedule_:
    - _epoch_: 1
      _modifications_:
        forward_mode:
          modules:
            gen_s1: eval_nograd
      _fit_:
        _stages_:
          process_disc:
            _optimizer_: optim_disc_stage_1
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - gen_s1
            - stage_2
            - gen_s2
            - disc_prediscrimination
            - disc_s2
          process_sample:
            _optimizer_: optim_gen_stage_1
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - gen_s1
            - stage_2
            - gen_s2
            - sample_prediscrimination
            - disc_s2
          process_reco:
            _optimizer_: optim_gen_stage_1
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - stage_1_reco
            - gen_s1
            - stage_2
            - stage_2_reco
            - gen_s2
            - reco_prediscrimination
      _val_:
        _datasets_:
          repeated_npz:
            _flows_:
            - stage_1_val
            - gen_s1
            - stage_2_val
            - gen_s2
            - val_prediscrimination
            - val_prediscrimination_post
    - _epoch_: 2
      _modifications_:
        forward_mode:
          modules:
            gen_s2: eval_nograd
      _fit_:
        _stages_:
          process_disc:
            _optimizer_: optim_disc_stage_2
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - gen_s1
            - stage_2
            - gen_s2
            - stage_3
            - gen_s3
            - disc_prediscrimination
            - disc_s3
          process_sample:
            _optimizer_: optim_gen_stage_2
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - gen_s1
            - stage_2
            - gen_s2
            - stage_3
            - gen_s3
            - sample_prediscrimination
            - disc_s3
          process_reco:
            _optimizer_: optim_gen_stage_2
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - stage_1_reco
            - gen_s1
            - stage_2
            - stage_2_reco
            - gen_s2
            - stage_3
            - stage_3_reco
            - gen_s3
            - reco_prediscrimination
      _val_:
        _datasets_:
          repeated_npz:
            _flows_:
            - stage_1_val
            - gen_s1
            - stage_2_val
            - gen_s2
            - stage_3_val
            - gen_s3
            - val_prediscrimination
            - val_prediscrimination_post
    - _epoch_: 3
      _modifications_:
        forward_mode:
          modules:
            gen_s3: eval_nograd
      _fit_:
        _stages_:
          process_disc:
            _optimizer_: optim_disc_stage_3
            _objective_: discriminate_last
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - gen_s1
            - stage_2
            - gen_s2
            - stage_3
            - gen_s3
            - stage_4
            - gen_s4
            - disc_prediscrimination_s4
            - disc_s4
          process_sample:
            _optimizer_: optim_gen_stage_3
            _objective_: sample_last
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - gen_s1
            - stage_2
            - gen_s2
            - stage_3
            - gen_s3
            - stage_4
            - gen_s4
            - sample_prediscrimination_s4
            - disc_s4
          process_reco:
            _optimizer_: optim_gen_stage_3
            _objective_: reco_last
            _flows_:
            - horizontal_input_mapping
            - stage_1
            - stage_1_reco
            - gen_s1
            - stage_2
            - stage_2_reco
            - gen_s2
            - stage_3
            - stage_3_reco
            - gen_s3
            - stage_4
            - stage_4_reco
            - gen_s4
            - reco_prediscrimination_s4
      _val_:
        _datasets_:
          repeated_npz:
            _flows_:
            - stage_1_val
            - gen_s1
            - stage_2_val
            - gen_s2
            - stage_3_val
            - gen_s3
            - stage_4_val
            - gen_s4
            - val_prediscrimination_last
            - val_prediscrimination_post
    _monitoring_:
      _test_:
        _datasets_:
          repeated_npz:
            _frequency_: 1
            _metrics_: []
            _monitors_:
            - export_generated_skeleton
DISC_FREQ: 5
GEN_FREQ: 1
REC_FREQ: 1
export_filepath: C:/Users/tsele/Documents/Mixamo/generated/bvh
bvh_filename: salsa-swing_dance
mdm_ckpt: C:/Users/tsele/Documents/t2m/text_mot_match/model/finest.tar
mode: run
action: test
